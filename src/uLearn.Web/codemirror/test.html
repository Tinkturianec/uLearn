<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>c# completition testing</title>
	<link rel="stylesheet" href="../qunit/qunit-1.15.0.css">
	<script src="../Scripts/jquery-1.10.2.min.js"></script>
	<script src="../qunit/qunit-1.15.0.js"></script>
	<script src="addon/hint/CsCompleter.js"> </script>
	</head>
	<body>
		<div id="qunit"></div>
		<div id="qunit-fixture"></div>

		<script>

			var keywords = [
				'abstract', 'add', 'alias', 'as', 'ascending', 'async', 'await', 'base', 'bool', 'break', 'byte',
				'case', 'catch', 'char', 'checked', 'class', 'const', 'continue', 'decimal', 'default', 'delegate',
				'descending', 'do', 'double', 'dynamic', 'else', 'enum', 'event', 'explicit', 'extern', 'false',
				'finally', 'fixed', 'float', 'for', 'foreach', 'from', 'get', 'global', 'goto', 'group', 'if',
				'implicit', 'in ', 'in', 'int', 'interface', 'internal', 'into', 'is', 'join', 'let', 'lock',
				'long', 'namespace', 'new', 'null', 'object', 'operator', 'orderby', 'out ', 'out', 'override',
				'params', 'partial ', 'private', 'protected', 'public', 'readonly', 'ref', 'remove', 'return',
				'sbyte', 'sealed', 'select', 'set', 'short', 'sizeof', 'stackalloc', 'static', 'string', 'struct',
				'switch', 'this', 'throw', 'true', 'try', 'typeof', 'uint', 'ulong', 'unchecked', 'unsafe', 'ushort',
				'using', 'value', 'var', 'virtual', 'void', 'volatile', 'where ', 'while', 'yield'
			];

			var completer = new CsCompleter(keywords);

			QUnit.module('Empty completion');
			QUnit.test('', function (assert) {
				var res = keywords;
				res.push(
					'Math', 'Console', 'Int32', 'Int64', 'Double', 'Boolean', 'Char', 'Array', 'Enumerable', 'List', 'Dictionary'
				);
				res.sort();
				assert.deepEqual(completer.getCompletions("", "", false), res, 'all');
				var resV = [];
				for (var i = 0; i < res.length; ++i) {
					if (res[i].charAt(0) == 'v')
						resV.push(res[i]);
				}
				assert.deepEqual(completer.getCompletions("", "v", false), resV, 'all');
			});

			QUnit.module('Static classes completion');
			QUnit.test('Math', function(assert) {
				assert.deepEqual(completer.getCompletions('Math', '', true), [
					'Abs', 'Acos', 'Asin', 'Atan', 'Atan2', 'BigMul', 'Ceiling', 'Cos', 'Cosh', 'DivRem', 'E',
					'Exp', 'Floor', 'IEEERemainder', 'Log', 'Log10', 'Max', 'Min', 'PI', 'Pow', 'Round', 'Sign',
					'Sin', 'Sinh', 'Sqrt', 'Tan', 'Tanh', 'Truncate'
				], 'Math all');
			});

			QUnit.test('Console', function(assert) {
				assert.deepEqual(completer.getCompletions('Console', '', true), [
					'BackgroundColor', 'Beep', 'BufferHeight', 'BufferWidth', 'CapsLock', 'Clear', 'CursorLeft',
					'CursorSize', 'CursorTop', 'CursorVisible', 'Error', 'ForegroundColor', 'In', 'InputEncoding',
					'IsErrorRedirected', 'IsInputRedirected', 'IsOutputRedirected', 'KeyAvailable', 'LargestWindowHeight',
					'LargestWindowWidth', 'MoveBufferArea', 'NumberLock', 'OpenStandardError', 'OpenStandardInput',
					'OpenStandardOutput', 'Out', 'OutputEncoding', 'Read', 'ReadKey', 'ReadLine', 'ResetColor',
					'SetBufferSize', 'SetCursorPosition', 'SetError', 'SetIn', 'SetOut', 'SetWindowPosition',
					'SetWindowSize', 'Title', 'TreatControlCAsInput', 'WindowHeight', 'WindowLeft', 'WindowTop',
					'WindowWidth', 'Write', 'WriteLine'
				], 'Console all');
			});

			QUnit.test('int', function(assert) {
				assert.deepEqual(completer.getCompletions('int', '', true), [
					'MaxValue', 'MinValue', 'Parse', 'TryParse'
				], 'int all');
				assert.deepEqual(completer.getCompletions('Int32', '', true), [
					'MaxValue', 'MinValue', 'Parse', 'TryParse'
				], 'Int32 all');
			});

			QUnit.test('long', function (assert) {
				assert.deepEqual(completer.getCompletions('long', '', true), [
					'MaxValue', 'MinValue', 'Parse', 'TryParse'
				], 'long all');
				assert.deepEqual(completer.getCompletions('Int64', '', true), [
					'MaxValue', 'MinValue', 'Parse', 'TryParse'
				], 'Int64 all');
			});

			QUnit.test('double', function (assert) {
				assert.deepEqual(completer.getCompletions('double', '', true), [
					'Epsilon', 'IsInfinity', 'IsNaN', 'IsNegativeInfinity', 'IsPositiveInfinity',
					'MaxValue', 'MinValue', 'NaN', 'NegativeInfinity', 'Parse', 'PositiveInfinity',
					'TryParse'
				], 'double all');
				assert.deepEqual(completer.getCompletions('Double', '', true), [
					'Epsilon', 'IsInfinity', 'IsNaN', 'IsNegativeInfinity', 'IsPositiveInfinity',
					'MaxValue', 'MinValue', 'NaN', 'NegativeInfinity', 'Parse', 'PositiveInfinity',
					'TryParse'
				], 'Double all');
			});

			QUnit.test('bool', function (assert) {
				assert.deepEqual(completer.getCompletions('bool', '', true), [
					'FalseString', 'Parse', 'TrueString', 'TryParse'
				], 'bool all');
				assert.deepEqual(completer.getCompletions('Boolean', '', true), [
					'FalseString', 'Parse', 'TrueString', 'TryParse'
				], 'Boolean all');
			});

			QUnit.test('char', function (assert) {
				assert.deepEqual(completer.getCompletions('char', '', true), [
					'ConvertFromUtf32', 'ConvertToUtf32', 'GetNumericValue', 'GetUnicodeCategory',
					'IsControl', 'IsDigit', 'IsHighSurrogate', 'IsLetter', 'IsLetterOrDigit',
					'IsLowSurrogate', 'IsLower', 'IsNumber', 'IsPunctuation', 'IsSeparator',
					'IsSurrogate', 'IsSurrogatePair', 'IsSymbol', 'IsUpper', 'IsWhiteSpace',
					'MaxValue', 'MinValue', 'Parse', 'ToLower', 'ToLowerInvariant', 'ToString',
					'ToUpper', 'ToUpperInvariant', 'TryParse'
				], 'char all');
				assert.deepEqual(completer.getCompletions('Char', '', true), [
					'ConvertFromUtf32', 'ConvertToUtf32', 'GetNumericValue', 'GetUnicodeCategory',
					'IsControl', 'IsDigit', 'IsHighSurrogate', 'IsLetter', 'IsLetterOrDigit',
					'IsLowSurrogate', 'IsLower', 'IsNumber', 'IsPunctuation', 'IsSeparator',
					'IsSurrogate', 'IsSurrogatePair', 'IsSymbol', 'IsUpper', 'IsWhiteSpace',
					'MaxValue', 'MinValue', 'Parse', 'ToLower', 'ToLowerInvariant', 'ToString',
					'ToUpper', 'ToUpperInvariant', 'TryParse'
				], 'Char all');
			});

			QUnit.test('string', function (assert) {
				assert.deepEqual(completer.getCompletions('string', '', true), [
					'Compare', 'CompareOrdinal', 'Concat', 'Copy', 'Empty', 'Equals', 'Format', 'Intern',
					'IsInterned', 'IsNullOrEmpty', 'IsNullOrWhiteSpace', 'Join'
				], 'string all');
				assert.deepEqual(completer.getCompletions('String', '', true), [
					'Compare', 'CompareOrdinal', 'Concat', 'Copy', 'Empty', 'Equals', 'Format', 'Intern',
					'IsInterned', 'IsNullOrEmpty', 'IsNullOrWhiteSpace', 'Join'
				], 'String all');
			});

			QUnit.test('Array', function (assert) {
				assert.deepEqual(completer.getCompletions('Array', '', true), [
					'AsReadOnly', 'BinarySearch', 'Clear', 'ConstrainedCopy', 'ConvertAll', 'Copy',
					'CreateInstance', 'Exists', 'Find', 'FindAll', 'FindIndex', 'FindLast', 'FindLastIndex',
					'ForEach', 'IndexOf', 'LastIndexOf', 'Resize', 'Reverse', 'Sort', 'TrueForAll'
				], 'Array all');
			});

			QUnit.test('Enumerable', function (assert) {
				assert.deepEqual(completer.getCompletions('Enumerable', '', true), [
					'Aggregate', 'All', 'Any', 'AsEnumerable', 'Average', 'Cast', 'Concat', 'Contains', 'Count',
					'DefaultIfEmpty', 'Distinct', 'ElementAt', 'ElementAtOrDefault', 'Empty', 'Except', 'First',
					'FirstOrDefault', 'GroupBy', 'GroupJoin', 'Intersect', 'Join', 'Last', 'LastOrDefault',
					'LongCount', 'Max', 'Min', 'OfType', 'OrderBy', 'OrderByDescending', 'Range', 'Repeat',
					'Reverse', 'Select', 'SelectMany', 'SequenceEqual', 'Single', 'SingleOrDefault', 'Skip',
					'SkipWhile', 'Sum', 'Take', 'TakeWhile', 'ThenBy', 'ThenByDescending', 'ToArray', 'ToDictionary',
					'ToList', 'ToLookup', 'Union', 'Where', 'Zip'
				], 'Enumerable all');
			});

			QUnit.test('List', function(assert) {
				assert.deepEqual(completer.getCompletions('List', '', true), [
				], 'List all');
			});

			QUnit.test('Dictionary', function (assert) {
				assert.deepEqual(completer.getCompletions('Dictionary', '', true), [
				], 'Dictionary all');
			});


			
			QUnit.module('Non-static class completion');
			QUnit.test('int', function (assert) {
				assert.deepEqual(completer.getCompletions('Length', '', true), [
					'CompareTo', 'Equals', 'GetHashCode', 'GetType', 'GetTypeCode', 'ToString'
				], 'Length all');
			});

			QUnit.test('long', function (assert) {
				assert.deepEqual(completer.getCompletions('BigMul', '', true), [
					'CompareTo', 'Equals', 'GetHashCode', 'GetType', 'GetTypeCode', 'ToString'
				], 'BigMul all');
			});

			QUnit.test('double', function (assert) {
				assert.deepEqual(completer.getCompletions('Acos', '', true), [
					'CompareTo', 'Equals', 'GetHashCode', 'GetType', 'GetTypeCode', 'ToString'
				], 'Acos all');
			});

			QUnit.test('bool', function (assert) {
				assert.deepEqual(completer.getCompletions('TryParse', '', true), [
					'CompareTo', 'Equals', 'GetHashCode', 'GetType', 'GetTypeCode', 'ToString'
				], 'TryParse all');
			});

			QUnit.test('char', function (assert) {
				assert.deepEqual(completer.getCompletions('Chars', '', true), [
					'CompareTo', 'Equals', 'GetHashCode', 'GetType', 'GetTypeCode', 'ToString'
				], 'Chars all');
			});

			QUnit.test('string', function (assert) {
				assert.deepEqual(completer.getCompletions('ToString', '', true), [
					'Aggregate', 'All', 'Any', 'AsEnumerable', 'AsParallel', 'AsQueryable', 'Average', 'Cast', 'Chars', 'Clone',
					'CompareTo', 'Concat', 'Contains', 'CopyTo', 'Count', 'DefaultIfEmpty', 'Distinct', 'ElementAt',
					'ElementAtOrDefault', 'EndsWith', 'Equals', 'Except', 'First', 'FirstOrDefault', 'GetEnumerator',
					'GetHashCode', 'GetType', 'GetTypeCode', 'GroupBy', 'GroupJoin', 'IndexOf', 'IndexOfAny', 'Insert',
					'Intersect', 'IsNormalized', 'Join', 'Last', 'LastIndexOf', 'LastIndexOfAny', 'LastOrDefault', 'Length',
					'LongCount', 'Max', 'Min', 'Normalize', 'OfType', 'OrderBy', 'OrderByDescending', 'PadLeft', 'PadRight',
					'Remove', 'Replace', 'Reverse', 'Select', 'SelectMany', 'SequenceEqual', 'Single', 'SingleOrDefault', 'Skip',
					'SkipWhile', 'Split', 'StartsWith', 'Substring', 'Sum', 'Take', 'TakeWhile', 'ToArray', 'ToCharArray',
					'ToDictionary', 'ToList', 'ToLookup', 'ToLower', 'ToLowerInvariant', 'ToString', 'ToUpper', 'ToUpperInvariant',
					'Trim', 'TrimEnd', 'TrimStart', 'Union', 'Where', 'Zip'
				], 'ToString all');
			});

			QUnit.test('Array', function (assert) {
				assert.deepEqual(completer.getCompletions('ToArray', '', true), [
					'AsParallel', 'AsQueryable', 'Cast', 'Clone', 'CopyTo', 'Equals',
					'GetEnumerator', 'GetHashCode', 'GetLength', 'GetLongLength', 'GetLowerBound',
					'GetType', 'GetUpperBound', 'GetValue', 'Initialize', 'IsFixedSize', 'IsReadOnly',
					'IsSynchronized', 'Length', 'LongLength', 'OfType', 'Rank',
					'SetValue', 'SyncRoot', 'ToString'
				], 'ToArray all');
			});

			QUnit.test('List', function(assert) {
				assert.deepEqual(completer.getCompletions('ToList', '', true), [
						'Add', 'AddRange', 'Aggregate', 'All', 'Any',
						'AsEnumerable', 'AsParallel', 'AsQueryable', 'AsReadOnly', 'Average', 'BinarySearch', 'Capacity', 'Cast',
						'Clear', 'Concat', 'Contains', 'ConvertAll', 'CopyTo', 'Count', 'DefaultIfEmpty', 'Distinct', 'ElementAt',
						'ElementAtOrDefault', 'Equals', 'Except', 'Exists', 'Find', 'FindAll', 'FindIndex', 'FindLast',
						'FindLastIndex', 'First', 'FirstOrDefault', 'ForEach', 'GetEnumerator', 'GetHashCode', 'GetRange', 'GetType',
						'GroupBy', 'GroupJoin', 'IndexOf', 'Insert', 'InsertRange', 'Intersect', 'Item', 'Join', 'Last',
						'LastIndexOf', 'LastOrDefault', 'LongCount', 'Max', 'Min', 'OfType', 'OrderBy',
						'OrderByDescending', 'Remove', 'RemoveAll', 'RemoveAt', 'RemoveRange', 'Reverse', 'Select', 'SelectMany',
						'SequenceEqual', 'Single', 'SingleOrDefault', 'Skip', 'SkipWhile', 'Sort', 'Sum', 'Take', 'TakeWhile',
						'ToArray', 'ToDictionary', 'ToList', 'ToLookup', 'ToString', 'TrimExcess', 'TrueForAll', 'Union', 'Where', 'Zip'
					],
					'ToList all');
				assert.deepEqual(completer.getCompletions('ToList', 'I', false), [
						'IndexOf', 'Insert', 'InsertRange', 'Intersect', 'Item'
					],
					'ToList I');
			});

			QUnit.test('Dictionary', function(assert) {
				assert.deepEqual(completer.getCompletions('ToDictionary', '', true), [
					'Add', 'Aggregate', 'All', 'Any',
					'AsEnumerable', 'AsParallel', 'AsQueryable', 'Average', 'Cast', 'Clear', 'Comparer', 'Concat', 'Contains',
					'ContainsKey', 'ContainsValue', 'Count', 'DefaultIfEmpty', 'Distinct', 'ElementAt', 'ElementAtOrDefault',
					'Equals', 'Except', 'First', 'FirstOrDefault', 'GetEnumerator', 'GetHashCode', 'GetObjectData',
					'GetType', 'GroupBy', 'GroupJoin', 'Intersect', 'Item', 'Join', 'Keys', 'Last', 'LastOrDefault', 'LongCount',
					'Max', 'Min', 'OfType', 'OnDeserialization', 'OrderBy', 'OrderByDescending', 'Remove',
					'Reverse', 'Select', 'SelectMany', 'SequenceEqual', 'Single', 'SingleOrDefault', 'Skip', 'SkipWhile', 'Sum',
					'Take', 'TakeWhile', 'ToArray', 'ToDictionary', 'ToList', 'ToLookup', 'ToString', 'TryGetValue', 'Union', 'Values',
					'Where', 'Zip'
				], 'ToDictionary all');
			});


			QUnit.module("Completeness of complition");
			var date = '25.11.14';
			QUnit.test('generated: ' + date, function(assert) {
				var tokens = {
					'var': 34, 'num1': 2, 'num2': 2, 'num3': 2, 'num4': 2, 'Console': 23,
					'WriteLine': 18, 'pi': 2, 'Math': 12, 'PI': 4, 'tenThousand': 2, 'floatPi': 2,
					'tenThousandPi': 3, 'roundedTenThousandPi': 2, 'Round': 2,
					'integerPartOfTenThousadnPi': 2, 'amount': 2, 'peopleCount': 2, 'totalMoney': 2,
					'doubleNumber': 2, 'number': 9, 'Parse': 6, 'CultureInfo': 2, 'InvariantCulture': 2,
					'a': 4, 'i': 54, 'Print': 1, 'text': 11, 'StringBuilder': 2, 'Replace': 2,
					'name': 8, 'Append': 2, 'Ceiling': 1, 'salary': 1, 'ToString': 5, 'code': 2,
					'Substring': 5, 'Length': 18, 'dx': 8, 'Abs': 2, 'to': 2, 'from': 2, 'dy': 8,
					'enemyInFront': 4, 'enemyName': 4, 'enemyHealth': 6, 'robotFirePower': 4, 'robotHealth': 7,
					'shouldFire': 5, 'Test': 1, 'Check': 1, 'ShouldFire': 1, 'ShouldFire2': 1, 'twoPowered': 6,
					'IsWhiteSpace': 1, 'bar': 6, 'y': 6, 'size': 2, 'x': 6, 'Write': 5, 'res': 3, 'count': 6,
					'maxIndex': 4, 'array': 17, 'item': 2, 'items': 3, 'itemToFind': 1, 'subArray': 5,
					'ContainsAtIndex': 2, 'startIndex': 5, 'ToArray': 6, 'circleWin': 3, 'HasWinSequence': 3,
					'field': 13, 'Mark': 6, 'Circle': 1, 'crossWin': 3, 'Cross': 1, 'GameResult': 4, 'Draw': 2,
					'CircleWin': 1, 'CrossWin': 1, 'mark': 11, 'IsLine': 9, 'x0': 2, 'y0': 2, 'words': 4, 'List': 4,
					'String': 1, 'line': 2, 'lines': 1, 'word': 21, 'Split': 2, 'Char': 1, 'IsUpper': 2, 'Add': 3,
					'Reverse': 1, 'Join': 1, 'dictionary': 5, 'Dictionary': 1, 'record': 3, 'contacts': 1, 'First': 1,
					'Min': 1, 'ContainsKey': 1, 'str': 5, 'command': 4, 'commands': 1, 'spaceIndex': 3, 'IndexOf': 2,
					'cmd': 3, 'arg': 3, 'len': 6, 'Remove': 1, 'WriteReversed': 1, 'MakeSubsets': 3, 'subset': 5,
					'position': 21, 'permutation': 4, 'index': 2, 'Array': 2, 'MakePermutations': 1, 'result': 4,
					'caseChangesLeft': 5, 'passwords': 5, 'password': 8, 'initialWord': 8, 'ToLower': 4,
					'MakePasswords': 3, 'IsLower': 1, 'ToUpper': 1, 'm': 4, 'left': 4, 'right': 4, 'value': 3,
					'BinSearchLeftBorder': 2, 'j': 13, 't': 2, 'Latitude': 1, 'Longitude': 1, 'City': 1,
					'GeoLocation': 1, 'Location': 1, 'Name': 1, 'GenerateMenuRight': 1, 'ToInt': 1, 'Int32': 1,
					'GetAlbumsEthalon': 1, 'files': 1, 'ImageName': 2, 'GaussianParameter': 2, 'Run': 1,
					'firstTime': 3, 'e': 2, 'arguments': 1, 'type': 3, 'arrays': 6, 'GetType': 2, 'GetElementType': 2,
					'Any': 1, 'z': 4, 'CreateInstance': 1, 'Sum': 1, 'ptr': 2, 'SetValue': 1, 'GetValue': 4,
					'IComparable': 3, 'min': 4, 'args': 4, 'CompareTo': 5, 'Title': 3, 'Theme': 3, 'obj': 2,
					'book': 3, 'Book': 1, 'themeCmp': 3, 'GetOrdinal': 3, 'Point': 8, 'p': 6, 'Atan2': 1, 'Y': 5,
					'X': 5, 'Compare': 1, 'A': 2, 'B': 2, 'C': 2, 'Format': 1, 'Select': 7, 'ToList': 3, 'nums': 3,
					'd': 3, 'SelectMany': 1, 'Where': 5, 'n': 2, 'Equals': 1, 'Distinct': 3, 'OrderBy': 2, 'Tuple': 3,
					'Create': 3, 'GroupBy': 1, 'w': 2, 'group': 3, 'Key': 1, 'Count': 1, 'OrderByDescending': 1, 'tuple': 4,
					'Item2': 2, 'ThenBy': 1, 'Item1': 2, 'Take': 1, 'doc': 1, 'Id': 1, 'ToLookup': 1, 'wd': 4, 'Sqrt': 1,
					'Vector': 1
				};

				var knownTokens = new SamePrefixArray();
				knownTokens.container = completer.unknown;
				for (var ind in completer.dictWithStatic) {
					knownTokens.AddAll(completer.dictWithStatic[ind]);
				}
				knownTokens.AddAll(completer.keywords);
				knownTokens.AddAll(completer.types);
				for (var str in completer.synonym) {
					knownTokens.Add(str);
				}
				knownTokens = knownTokens.getArray();

				var unknownTokens = [];
				for (var str in tokens) {
					if (!arrayContains(knownTokens, str)) {
						unknownTokens.push(str);
					}
				}

				assert.equal(unknownTokens.length, 0, 'count of unknown tokens');
				assert.deepEqual(unknownTokens.sort(), [], 'list of unknown tokens');
			});
		</script>

	</body>
</html>